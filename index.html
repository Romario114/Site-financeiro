<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Controle Financeiro </title>
<style>
  *{box-sizing:border-box;font-family:Inter,Arial, sans-serif}
  body{background:#f5f7fb;padding:24px;color:#222}
  .container{max-width:1100px;margin:0 auto}
  h1{font-size:28px;text-align:center;margin-bottom:18px}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:18px;margin-bottom:18px}
  .card{background:#fff;padding:16px;border-radius:12px;box-shadow:0 6px 18px rgba(12,24,50,.06)}
  label{display:block;font-size:13px;margin-top:8px;color:#555}
  input{width:100%;padding:10px;border:1px solid #e2e6ef;border-radius:8px;margin-top:6px}
  button{margin-top:10px;padding:10px 12px;border-radius:8px;border:0;background:#4a67ff;color:#fff;font-weight:600;cursor:pointer}
  table{width:100%;border-collapse:collapse;margin-top:12px}
  th,td{padding:10px;border-bottom:1px solid #eef1fb;text-align:left;font-size:14px}
  th{background:#4a67ff;color:#fff;border-top-left-radius:8px;border-top-right-radius:8px}
  .actions button{margin-right:6px;padding:6px 8px;border-radius:6px;border:0;cursor:pointer}
  .btn-edit{background:#f5a623;color:#fff}
  .btn-delete{background:#ff4d4d;color:#fff}
  .summary{display:flex;gap:12px;margin-top:8px}
  .summary .item{flex:1;background:#fff;padding:12px;border-radius:10px;text-align:center;box-shadow:0 6px 18px rgba(12,24,50,.04)}
  .muted{font-size:13px;color:#666}

  /* ‚≠ê AVISO DE SALDO BAIXO */
  #avisoSaldo {
    text-align:center;
    color:#b00020;
    font-weight:700;
    margin-top:12px;
    font-size:16px;
    display:none;
  }

  @media(max-width:860px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="container">
  <h1>üíº Controle Financeiro </h1>

  <div class="grid">
    <div class="card">
      <h2>Adicionar Renda</h2>
      <label>Data
        <input id="dataRenda" type="date">
      </label>
      <label>Nome da renda
        <input id="nomeRenda" type="text" placeholder="Ex: Venda, Sal√°rio, Pix">
      </label>
      <label>Valor (R$)
        <input id="valorRenda" type="number" step="0.01" placeholder="Ex: 50.00">
      </label>
      <button id="btnAddRenda">Salvar Renda</button>

      <table id="tabelaRendas">
        <thead>
          <tr><th>Data</th><th>Nome</th><th>Valor</th><th>A√ß√µes</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="card">
      <h2>Adicionar Despesa</h2>
      <label>Data
        <input id="dataDespesa" type="date">
      </label>
      <label>Descri√ß√£o
        <input id="descDespesa" type="text" placeholder="Ex: Conta, Mercado">
      </label>
      <label>Valor (R$)
        <input id="valorDespesa" type="number" step="0.01" placeholder="Ex: 30.00">
      </label>
      <button id="btnAddDespesa">Salvar Despesa</button>

      <table id="tabelaDespesas">
        <thead>
          <tr><th>Data</th><th>Descri√ß√£o</th><th>Valor</th><th>A√ß√µes</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <div class="summary">
    <div class="item">
      <div class="muted">Total de Rendas</div>
      <div id="totalRendas" style="font-weight:700;font-size:20px">R$ 0.00</div>
    </div>
    <div class="item">
      <div class="muted">Total de Despesas</div>
      <div id="totalDespesas" style="font-weight:700;font-size:20px">R$ 0.00</div>
    </div>
    <div class="item">
      <div class="muted">Saldo</div>
      <div id="saldo" style="font-weight:700;font-size:20px">R$ 0.00</div>
    </div>
  </div>

  <!-- ‚≠ê AVISO APARECE AQUI -->
  <div id="avisoSaldo">‚ö†Ô∏è Cuidado! Seu saldo est√° acabando!</div>

</div>

<script>
/* ====== Dados ====== */
let rendas = JSON.parse(localStorage.getItem('rendas')) || [];
let despesas = JSON.parse(localStorage.getItem('despesas')) || [];

/* ====== Elementos ====== */
const tabelaRendasBody = document.querySelector('#tabelaRendas tbody');
const tabelaDespesasBody = document.querySelector('#tabelaDespesas tbody');

const elDataRenda = document.getElementById('dataRenda');
const elNomeRenda = document.getElementById('nomeRenda');
const elValorRenda = document.getElementById('valorRenda');
const btnAddRenda = document.getElementById('btnAddRenda');

const elDataDesp = document.getElementById('dataDespesa');
const elDescDesp = document.getElementById('descDespesa');
const elValorDesp = document.getElementById('valorDespesa');
const btnAddDespesa = document.getElementById('btnAddDespesa');

const elTotalRendas = document.getElementById('totalRendas');
const elTotalDespesas = document.getElementById('totalDespesas');
const elSaldo = document.getElementById('saldo');
const avisoSaldo = document.getElementById('avisoSaldo'); // ‚≠ê

/* ====== Render ====== */
function render() {

  // RENDAS
  tabelaRendasBody.innerHTML = '';
  let totalR = 0;
  rendas.forEach((r, idx) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${r.data}</td>
      <td>${r.nome}</td>
      <td>${formatMoney(r.valor)}</td>
      <td class="actions">
        <button class="btn-edit" onclick="abrirEdicaoRenda(${idx})">‚úè Editar</button>
        <button class="btn-delete" onclick="excluirRenda(${idx})">üóë Excluir</button>
      </td>
    `;
    tabelaRendasBody.appendChild(tr);
    totalR += Number(r.valor);
  });

  // DESPESAS
  tabelaDespesasBody.innerHTML = '';
  let totalD = 0;
  despesas.forEach((d, idx) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${d.data}</td>
      <td>${d.descricao}</td>
      <td>${formatMoney(d.valor)}</td>
      <td class="actions">
        <button class="btn-edit" onclick="abrirEdicaoDespesa(${idx})">‚úè Editar</button>
        <button class="btn-delete" onclick="excluirDespesa(${idx})">üóë Excluir</button>
      </td>
    `;
    tabelaDespesasBody.appendChild(tr);
    totalD += Number(d.valor);
  });

  const saldo = totalR - totalD;

  elTotalRendas.textContent = formatMoney(totalR);
  elTotalDespesas.textContent = formatMoney(totalD);
  elSaldo.textContent = formatMoney(saldo);

  // ‚≠ê L√ìGICA DO AVISO DE SALDO BAIXO
  const limite = totalR * 0.20; // 20% das rendas
  if (saldo > 0 && saldo < limite) {
    avisoSaldo.style.display = "block";
    avisoSaldo.textContent = `‚ö†Ô∏è Aten√ß√£o! Seu saldo est√° baixo: ${formatMoney(saldo)}`;
  } else if (saldo <= 0) {
    avisoSaldo.style.display = "block";
    avisoSaldo.textContent = `‚ùå Voc√™ est√° no negativo: ${formatMoney(saldo)}`;
  } else {
    avisoSaldo.style.display = "none";
  }

  salvar();
}

/* ====== Helpers ====== */
function formatMoney(v){ return 'R$ ' + (Number(v)||0).toFixed(2); }
function salvar(){
  localStorage.setItem('rendas', JSON.stringify(rendas));
  localStorage.setItem('despesas', JSON.stringify(despesas));
}

/* ====== A√ß√µes ====== */
btnAddRenda.onclick = () => {
  const data = elDataRenda.value;
  const nome = elNomeRenda.value.trim();
  const valor = parseFloat(elValorRenda.value);
  if(!data || !nome || isNaN(valor)) return alert('Preencha tudo corretamente!');
  rendas.push({data, nome, valor:Number(valor.toFixed(2))});
  elDataRenda.value = ''; elNomeRenda.value = ''; elValorRenda.value = '';
  render();
};

btnAddDespesa.onclick = () => {
  const data = elDataDesp.value;
  const descricao = elDescDesp.value.trim();
  const valor = parseFloat(elValorDesp.value);
  if(!data || !descricao || isNaN(valor)) return alert('Preencha tudo corretamente!');
  despesas.push({data, descricao, valor:Number(valor.toFixed(2))});
  elDataDesp.value = ''; elDescDesp.value = ''; elValorDesp.value = '';
  render();
};

function excluirRenda(i){ if(confirm('Excluir?')){ rendas.splice(i,1); render(); } }
function excluirDespesa(i){ if(confirm('Excluir?')){ despesas.splice(i,1); render(); } }

function abrirEdicaoRenda(i){
  const r = rendas[i];
  const d = prompt("Data:", r.data);
  if(d===null) return;
  const n = prompt("Nome:", r.nome);
  if(n===null) return;
  const v = parseFloat(prompt("Valor:", r.valor));
  if(isNaN(v)) return alert("Valor inv√°lido");
  rendas[i] = {data:d, nome:n, valor:Number(v.toFixed(2))};
  render();
}

function abrirEdicaoDespesa(i){
  const d = despesas[i];
  const da = prompt("Data:", d.data);
  if(da===null) return;
  const desc = prompt("Descri√ß√£o:", d.descricao);
  if(desc===null) return;
  const v = parseFloat(prompt("Valor:", d.valor));
  if(isNaN(v)) return alert("Valor inv√°lido");
  despesas[i] = {data:da, descricao:desc, valor:Number(v.toFixed(2))};
  render();
}

/* ===== Inicial ===== */
render();
</script>
</body>
</html>
